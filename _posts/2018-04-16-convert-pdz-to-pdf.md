---
date: 2018-04-16 18:33:50+08:00
layout: post
title: 超星的PDZ文件转PDF的一般方法
categories: 技术随笔
tags: 
---

超星图书馆保存了我国很多珍贵的学术书籍，网上找不到的老书基本都能在它上面找到，而且画面质量很好。

但是它使用了专门的格式，就不能满足我们在移动设备上使用的需求。当然，移动设备上装个超星的移动图书馆就行。但是江南大学的时候还可以登录，现在北大却登录不了，据说是没有购买这一功能。

转换超星的pdg/pdz为pdf主要就是获取每页的图片，然后将其转为pdf，再加上书签。

一种方法是通过windows上的xps document打印为oxps文件，再转为pdf。

另一种方法是在阅读器打开时，进入用户的appdata/local/temp/buffer，复制生成的浏览的页面的bmp文件，我们可以用adobe acrobat将其转为pdf。获取buffer的图片，我们可以用按键精灵、autoit之类的程序控制超星阅读器进行翻页，然后复制图片。一般对于不能逆向或者挂钩子的东西，用脚本语言是比较方便的。

另外，我们也可以直接从网页上爬取网页上的图片。只要在web上的东西，基本都能获取。注意的是，放大图片的话，生成的图片质量也会提高。

之后还要给pdf瘦身，可以用abbyy finereader转换为可搜索的pdf。如果识别的效果好，会自动给目录加上跳转的章节的链接。


生成书签的话，有人写出了读取pdg文件书签的程序。能够做得逆向破解是最好的，但是我技术不够。不过因为一般目录不会太多，采用人工加书签的方法也是可以的。



